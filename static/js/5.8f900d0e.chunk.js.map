{"version":3,"sources":["api/project.ts","api/user.ts","utils/reorder.ts","utils/use-optimistic-option.ts","utils/project.ts","components/id-select.tsx","screens/project-list/utils.ts","assets/software-logo.svg","screens/project-list/project-modal.tsx","components/project-popover.tsx","components/user-popover.tsx","authenticated-app/index.tsx"],"names":["useProjects","param","http","useHttp","useQuery","cleanObject","data","useEditProject","queryKey","useMutation","params","id","method","useEditConfig","useAddProject","useAddConfig","useDeleteProject","useDeleteConfig","useProject","enabled","useUser","reorder","fromId","type","referenceId","list","copiedList","movingItemIndex","findIndex","item","insertAfter","length","targetIndex","insertBefore","from","to","toItem","removedItem","splice","toIndex","indexOf","useConfig","callback","queryClient","useQueryClient","onSuccess","invalidateQueries","onMutate","target","a","previousItems","getQueryData","setQueryData","old","onError","error","newItem","ctx","filter","map","useReorderBoardConfig","useReorderTaskConfig","kanbanId","toKanbanId","useProjectModal","useUrlQueryParam","projectCreate","setProjectCreate","editProjectId","setEditProjectId","setUrlParams","useSetUrlQueryParam","Number","projectModalOpen","editingProject","isLoading","open","close","edit","IdSelect","props","value","onChange","defaultOptionName","options","resetProp","toNumber","undefined","Option","name","isNaN","useProjectsSearchParams","setParam","useMemo","personId","useProjectsQueryKey","_image","_image2","_excluded","_extends","Object","assign","i","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgSoftwareLogo","_ref","svgRef","title","titleId","xmlns","xmlnsXlink","width","height","viewBox","ref","x","y","xlinkHref","ForwardRef","formItemLayout","ProjectModal","users","useMutateProject","Form","useForm","form","mutateAsync","mutateLoading","useEffect","setFieldsValue","resetFields","forceRender","visible","onClose","Container","size","layout","onFinish","values","then","style","Item","label","rules","required","message","placeholder","BtnFormItem","htmlType","loading","disabled","styled","div","ProjectPopover","projects","refetch","Content","ContentContaier","Text","pin","Meta","onClick","placement","content","onVisibleChange","UserPopover","ContentContainer","user","ProjectList","React","lazy","ProjectScreen","Header","AuthenticatedApp","Main","replace","path","element","navigate","useNavigate","PageHeader","between","HeaderLeft","gap","HeaderRight","User","useAuth","logout","overlay","Row","main"],"mappings":"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","file":"static/js/5.8f900d0e.chunk.js","sourcesContent":["import { useHttp } from \"plugins/request\";\r\nimport { cleanObject } from \"utils\";\r\nimport { useQuery, useMutation, QueryKey } from \"react-query\";\r\nimport {\r\n  useEditConfig,\r\n  useAddConfig,\r\n  useDeleteConfig,\r\n} from \"utils/use-optimistic-option\";\r\nimport { Project } from \"types/project\";\r\n\r\n/* project 列表 */\r\nexport const useProjects = (param?: Partial<Project>) => {\r\n  const http = useHttp();\r\n\r\n  return useQuery<Project[]>([\"projects\", cleanObject(param)], () =>\r\n    http(\"projects\", { data: param })\r\n  );\r\n  /* const { run, ...reslut } = useAsync<Project[]>();\r\n  const fetchProjects = useCallback(\r\n    () => http(\"projects\", { data: cleanObject(param || {}) }),\r\n    [http, param]\r\n  );\r\n\r\n  useEffect(() => {\r\n    run(fetchProjects(), { retry: fetchProjects });\r\n  }, [param, run, fetchProjects]);\r\n\r\n  return reslut; */\r\n};\r\n\r\n/* 更改项目信息 */\r\nexport const useEditProject = (queryKey: QueryKey) => {\r\n  const http = useHttp();\r\n\r\n  return useMutation(\r\n    (params: Partial<Project>) =>\r\n      http(`projects/${params.id}`, { data: params, method: \"PATCH\" }),\r\n    useEditConfig(queryKey)\r\n  );\r\n\r\n  /* const { run, ...asyncResult } = useAsync();\r\n  const mutate = (params: Partial<Project>) => {\r\n    return run(\r\n      http(`projects/${params.id}`, {\r\n        data: params,\r\n        method: \"PATCH\",\r\n      })\r\n    );\r\n  };\r\n\r\n  return {\r\n    mutate,\r\n    ...asyncResult,\r\n  }; */\r\n};\r\n\r\n/* 添加项目 */\r\nexport const useAddProject = (queryKey: QueryKey) => {\r\n  const http = useHttp();\r\n  return useMutation((params: Partial<Project>) => {\r\n    return http(\"projects\", { data: params, method: \"POST\" });\r\n  }, useAddConfig(queryKey));\r\n  /* const { run, ...asyncResult } = useAsync();\r\n  const mutate = (params: Partial<Project>) => {\r\n    return run(\r\n      http(`/projects/${params.id}`, {\r\n        data: params,\r\n        method: \"POST\",\r\n      })\r\n    );\r\n  };\r\n\r\n  return {\r\n    mutate,\r\n    ...asyncResult,\r\n  }; */\r\n};\r\n\r\n/* 删除项目 */\r\nexport const useDeleteProject = (queryKey: QueryKey) => {\r\n  const http = useHttp();\r\n  return useMutation(({ id }: { id: number }) => {\r\n    return http(`projects/${id}`, { method: \"DELETE\" });\r\n  }, useDeleteConfig(queryKey));\r\n};\r\n\r\n/* 查询project详情 */\r\nexport const useProject = (id?: number) => {\r\n  const http = useHttp();\r\n  return useQuery<Project>([\"project\", { id }], () => http(`projects/${id}`), {\r\n    enabled: !!id,\r\n  });\r\n};\r\n","import { useHttp } from \"plugins/request\";\r\nimport { useAsync } from \"utils/custom-hook\";\r\nimport { useEffect } from \"react\";\r\nimport { cleanObject } from \"utils\";\r\nimport { useQuery } from \"react-query\";\r\nimport { User } from \"types/user\";\r\n\r\n/* 获取负责人列表 */\r\nexport const useUser = (param?: Partial<User>) => {\r\n  const http = useHttp();\r\n  return useQuery<User[]>([\"users\", cleanObject(param)], () =>\r\n    http(\"users\", { data: cleanObject(param) })\r\n  );\r\n  /* const { run, ...result } = useAsync<User[]>();\r\n\r\n  useEffect(() => {\r\n    run(http(\"users\", { data: cleanObject(param) }));\r\n  }, [param, http, run]);\r\n\r\n  return result; */\r\n};\r\n","/**\r\n * 在本地对排序进行乐观更新\r\n * @param fromId 要排序的项目的id\r\n * @param type 'before' | 'after'\r\n * @param referenceId 参照id\r\n * @param list 要排序的列表, 比如tasks, kanbans\r\n */\r\nexport const reorder = ({\r\n  fromId,\r\n  type,\r\n  referenceId,\r\n  list,\r\n}: {\r\n  list: { id: number }[];\r\n  fromId: number;\r\n  type: \"after\" | \"before\";\r\n  referenceId: number;\r\n}) => {\r\n  const copiedList = [...list];\r\n  // 找到fromId对应项目的下标\r\n  const movingItemIndex = copiedList.findIndex((item) => item.id === fromId);\r\n  if (!referenceId) {\r\n    return insertAfter([...copiedList], movingItemIndex, copiedList.length - 1);\r\n  }\r\n  const targetIndex = copiedList.findIndex((item) => item.id === referenceId);\r\n  const insert = type === \"after\" ? insertAfter : insertBefore;\r\n  return insert([...copiedList], movingItemIndex, targetIndex);\r\n};\r\n\r\n/**\r\n * 在list中，把from放在to的前边\r\n * @param list\r\n * @param from\r\n * @param to\r\n */\r\nconst insertBefore = (list: unknown[], from: number, to: number) => {\r\n  const toItem = list[to];\r\n  const removedItem = list.splice(from, 1)[0];\r\n  const toIndex = list.indexOf(toItem);\r\n  list.splice(toIndex, 0, removedItem);\r\n  return list;\r\n};\r\n\r\n/**\r\n * 在list中，把from放在to的后面\r\n * @param list\r\n * @param from\r\n * @param to\r\n */\r\nconst insertAfter = (list: unknown[], from: number, to: number) => {\r\n  const toItem = list[to];\r\n  const removedItem = list.splice(from, 1)[0];\r\n  const toIndex = list.indexOf(toItem);\r\n  list.splice(toIndex + 1, 0, removedItem);\r\n  return list;\r\n};\r\n","import { useQueryClient, QueryKey } from \"react-query\";\r\nimport { Task } from \"types/task\";\r\nimport { reorder } from \"./reorder\";\r\n\r\n/* 乐观更新配置项 */\r\nexport const useConfig = (\r\n  queryKey: QueryKey,\r\n  callback: (target: any, old?: any[]) => any[]\r\n) => {\r\n  const queryClient = useQueryClient();\r\n  return {\r\n    onSuccess: () => queryClient.invalidateQueries(queryKey),\r\n    onMutate: async (target: any) => {\r\n      /* 获取缓存数据 */\r\n      const previousItems = queryClient.getQueryData(queryKey);\r\n      /* 设置修改后的数据 */\r\n      queryClient.setQueryData(queryKey, (old?: any[]) => {\r\n        return callback(target, old);\r\n      });\r\n\r\n      /* return 的值可以在 onError 第三个参数(context)取得 */\r\n      return { previousItems };\r\n    },\r\n    onError: (error: any, newItem: any, ctx: any) => {\r\n      queryClient.setQueryData(queryKey, ctx.previousItems);\r\n    },\r\n  };\r\n};\r\n\r\n/* delete：保留与target id 不同的值 */\r\nexport const useDeleteConfig = (queryKey: QueryKey) => {\r\n  return useConfig(queryKey, (target: any, old?: any[]) => {\r\n    return old?.filter((item) => item.id !== target.id) || [];\r\n  });\r\n};\r\n\r\n/* edit：覆盖id相同项 */\r\nexport const useEditConfig = (queryKey: QueryKey) => {\r\n  return useConfig(queryKey, (target: any, old?: any[]) => {\r\n    return (\r\n      old?.map((item) => {\r\n        if (item.id === target.id) return { ...item, ...target };\r\n        return item;\r\n      }) || []\r\n    );\r\n  });\r\n};\r\n\r\n/* add：添加项 */\r\nexport const useAddConfig = (queryKey: QueryKey) => {\r\n  return useConfig(queryKey, (target: any, old?: any[]) => {\r\n    return old ? [...old, target] : [];\r\n  });\r\n};\r\n\r\n/* reorder: 排序 */\r\nexport const useReorderConfig = (queryKey: QueryKey) => {\r\n  return useConfig(queryKey, (target: any, old?: any[]) => old || []);\r\n};\r\n\r\n/* 看板排序乐观更新 */\r\nexport const useReorderBoardConfig = (queryKey: QueryKey) =>\r\n  useConfig(queryKey, (target, old) => reorder({ list: old, ...target }));\r\n\r\n/* 任务排序 */\r\nexport const useReorderTaskConfig = (queryKey: QueryKey) =>\r\n  useConfig(queryKey, (target, old) => {\r\n    const orderedList = reorder({ list: old, ...target }) as Task[];\r\n    return orderedList.map((item) =>\r\n      item.id === target.fromId\r\n        ? { ...item, kanbanId: target.toKanbanId }\r\n        : item\r\n    );\r\n  });\r\n","import { useProject } from \"api/project\";\r\nimport { useSetUrlQueryParam, useUrlQueryParam } from \"./custom-hook\";\r\n\r\n/* Project state management */\r\nexport const useProjectModal = () => {\r\n  const [{ projectCreate }, setProjectCreate] = useUrlQueryParam([\r\n    \"projectCreate\",\r\n  ]);\r\n\r\n  const [{ editProjectId }, setEditProjectId] = useUrlQueryParam([\r\n    \"editProjectId\",\r\n  ]);\r\n\r\n  const setUrlParams = useSetUrlQueryParam();\r\n\r\n  const { data: editingProject, isLoading } = useProject(Number(editProjectId));\r\n\r\n  const open = () => setProjectCreate({ projectCreate: true });\r\n  const close = () => setUrlParams({ projectCreate: \"\", editProjectId: \"\" });\r\n  const edit = (id: number) => setEditProjectId({ editProjectId: id });\r\n\r\n  return {\r\n    projectModalOpen: projectCreate === \"true\" || !!editProjectId,\r\n    editingProject,\r\n    isLoading,\r\n    open,\r\n    close,\r\n    edit,\r\n  };\r\n};\r\n","import React from \"react\";\r\nimport { Select } from \"antd\";\r\nimport { Raw } from \"types\";\r\n\r\n/** https://react-typescript-cheatsheet.netlify.app/docs/advanced/patterns_by_usecase/#componentprops */\r\ntype SelectProps = React.ComponentProps<typeof Select>;\r\n\r\ninterface IdSelectProps\r\n  extends Omit<\r\n    SelectProps,\r\n    \"value\" | \"onChange\" | \"defaultOptionName\" | \"options\"\r\n  > {\r\n  value?: Raw | null | undefined;\r\n  onChange?: (value?: number) => void;\r\n  defaultOptionName?: string;\r\n  options?: { name: string; id: number }[];\r\n}\r\n\r\n/**\r\n * value 可传入多种类型\r\n * onChange 只会回调 number | undefined\r\n * 当 Number(value) === NaN 时, 代表选择默认选项\r\n * 选择默认选项时，onChage 会回调 undefined\r\n */\r\nexport const IdSelect = (props: IdSelectProps) => {\r\n  const { value, onChange, defaultOptionName, options, ...resetProp } = props;\r\n  return (\r\n    <Select\r\n      value={options?.length ? toNumber(value) : 0}\r\n      onChange={(value) => onChange && onChange(toNumber(value) || undefined)}\r\n      {...resetProp}\r\n    >\r\n      {defaultOptionName ? (\r\n        <Select.Option value={0}>{defaultOptionName}</Select.Option>\r\n      ) : null}\r\n      {options &&\r\n        options.map(({ id, name }) => (\r\n          <Select.Option value={id} key={id}>\r\n            {name}\r\n          </Select.Option>\r\n        ))}\r\n    </Select>\r\n  );\r\n};\r\n\r\nconst toNumber = (value: unknown) => (isNaN(Number(value)) ? 0 : Number(value));\r\n","import { useMemo } from \"react\";\r\nimport { useUrlQueryParam } from \"utils/custom-hook\";\r\n\r\nexport const useProjectsSearchParams = () => {\r\n  const [params, setParam] = useUrlQueryParam([\"name\", \"personId\"]);\r\n  return [\r\n    useMemo(\r\n      () => ({ ...params, personId: Number(params.personId) || undefined }),\r\n      [params]\r\n    ),\r\n    setParam,\r\n  ] as const;\r\n};\r\n\r\n/* 乐观更新 query key */\r\nexport const useProjectsQueryKey = () => {\r\n  const [searchParams] = useProjectsSearchParams();\r\n  return [\"projects\", searchParams];\r\n};\r\n","var _image, _image2;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSoftwareLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 632,\n    height: 108,\n    viewBox: \"0 0 632 108\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _image || (_image = /*#__PURE__*/React.createElement(\"image\", {\n    id: \"logo_2x\",\n    \"data-name\": \"logo@2x\",\n    x: 5,\n    y: 1,\n    width: 118,\n    height: 107,\n    xlinkHref: \"data:img/png;base64,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\"\n  })), _image2 || (_image2 = /*#__PURE__*/React.createElement(\"image\", {\n    id: \"software\",\n    x: 151,\n    y: 12,\n    width: 466,\n    height: 76,\n    xlinkHref: \"data:img/png;base64,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\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSoftwareLogo);\nexport default __webpack_public_path__ + \"static/media/software-logo.df066984.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect } from \"react\";\r\nimport { Drawer, Spin, Form, Input, Button } from \"antd\";\r\nimport { useProjectModal } from \"utils/project\";\r\nimport { IdSelect } from \"components/id-select\";\r\nimport { useUser } from \"api/user\";\r\nimport { useAddProject, useEditProject } from \"api/project\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useProjectsQueryKey } from \"./utils\";\r\n\r\nconst formItemLayout = {\r\n  // labelCol: { span: 6 },\r\n  // wrapperCol: { span: 14 },\r\n};\r\n\r\nexport const ProjectModal = () => {\r\n  const { data: users } = useUser();\r\n  const { projectModalOpen, editingProject, isLoading, close } =\r\n    useProjectModal();\r\n  const useMutateProject = editingProject ? useEditProject : useAddProject;\r\n\r\n  const [form] = Form.useForm();\r\n  const {\r\n    mutateAsync,\r\n    error,\r\n    isLoading: mutateLoading,\r\n  } = useMutateProject(useProjectsQueryKey());\r\n  const onFinish = (values: {\r\n    name: string;\r\n    organization: string;\r\n    personId: number;\r\n  }) => {\r\n    /* 传入old and new data，新数据覆盖旧数据 */\r\n    mutateAsync({ ...editingProject, ...values }).then(() => {\r\n      form.resetFields();\r\n      close();\r\n    });\r\n  };\r\n\r\n  /* 设置默认值 (只有在编辑时), 卸载组件则重置表单 */\r\n  useEffect(() => {\r\n    form.setFieldsValue(editingProject);\r\n    return form.resetFields;\r\n  }, [editingProject, form]);\r\n\r\n  const title = editingProject ? \"编辑项目\" : \"创建项目\";\r\n\r\n  return (\r\n    <Drawer forceRender visible={projectModalOpen} onClose={close} width=\"100%\">\r\n      <Container>\r\n        {isLoading ? (\r\n          <Spin size={\"large\"} />\r\n        ) : (\r\n          <>\r\n            <h1>{title}</h1>\r\n            {error ? <ErrorBox error={error} /> : null}\r\n            <Form\r\n              form={form}\r\n              layout={\"vertical\"}\r\n              onFinish={onFinish}\r\n              style={{ width: \"40rem\" }}\r\n            >\r\n              <Form.Item\r\n                label={\"名称\"}\r\n                name={\"name\"}\r\n                rules={[{ required: true, message: \"请输入项目名称\" }]}\r\n                {...formItemLayout}\r\n              >\r\n                <Input placeholder={\"请输入项目名称\"} />\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                label={\"部门\"}\r\n                name={\"organization\"}\r\n                rules={[{ required: true, message: \"请输入部门名称\" }]}\r\n                {...formItemLayout}\r\n              >\r\n                <Input placeholder={\"请输入部门名称\"} />\r\n              </Form.Item>\r\n\r\n              <Form.Item label={\"负责人\"} name={\"personId\"} {...formItemLayout}>\r\n                <IdSelect defaultOptionName={\"负责人\"} options={users || []} />\r\n              </Form.Item>\r\n\r\n              <BtnFormItem>\r\n                <Button\r\n                  type=\"primary\"\r\n                  htmlType=\"submit\"\r\n                  loading={mutateLoading}\r\n                  disabled={mutateLoading}\r\n                >\r\n                  提交\r\n                </Button>\r\n              </BtnFormItem>\r\n            </Form>\r\n          </>\r\n        )}\r\n      </Container>\r\n    </Drawer>\r\n  );\r\n};\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  height: 80vh;\r\n`;\r\n\r\nconst BtnFormItem = styled(Form.Item)`\r\n  text-align: right;\r\n`;\r\n","import React from \"react\";\r\nimport { Popover, Typography, List, Divider } from \"antd\";\r\nimport { useProjects } from \"api/project\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ButtonNoPadding } from \"./lib\";\r\nimport { useProjectModal } from \"utils/project\";\r\n\r\n/**\r\n * header \"项目\" pop over\r\n */\r\nexport const ProjectPopover = () => {\r\n  const { data: projects, refetch } = useProjects();\r\n  const { open } = useProjectModal();\r\n\r\n  const Content = (\r\n    <ContentContaier>\r\n      <Typography.Text type={\"secondary\"}>收藏项目</Typography.Text>\r\n      <List>\r\n        {projects\r\n          ?.filter((item) => item.pin)\r\n          .map((item) => (\r\n            <List.Item key={item.id}>\r\n              <List.Item.Meta title={item.name} />\r\n            </List.Item>\r\n          ))}\r\n      </List>\r\n      <Divider />\r\n      <ButtonNoPadding type={\"link\"} onClick={open}>\r\n        创建项目\r\n      </ButtonNoPadding>\r\n    </ContentContaier>\r\n  );\r\n\r\n  return (\r\n    <Popover\r\n      placement={\"bottom\"}\r\n      content={Content}\r\n      onVisibleChange={() => refetch}\r\n    >\r\n      <span>项目</span>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nconst ContentContaier = styled.div`\r\n  min-width: 24rem;\r\n`;\r\n","import React from \"react\";\r\nimport { Divider, List, Popover, Typography } from \"antd\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useUser } from \"api/user\";\r\n\r\nexport const UserPopover = () => {\r\n  const { data: users, refetch } = useUser();\r\n\r\n  const content = (\r\n    <ContentContainer>\r\n      <Typography.Text type={\"secondary\"}>组员列表</Typography.Text>\r\n      <List>\r\n        {users?.map((user) => (\r\n          <List.Item key={user.id}>\r\n            <List.Item.Meta title={user.name} />\r\n          </List.Item>\r\n        ))}\r\n      </List>\r\n    </ContentContainer>\r\n  );\r\n\r\n  return (\r\n    <Popover\r\n      onVisibleChange={() => refetch()}\r\n      placement={\"bottom\"}\r\n      content={content}\r\n    >\r\n      <span>组员</span>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nconst ContentContainer = styled.div`\r\n  min-width: 30rem;\r\n`;\r\n","import React from \"react\";\r\nimport { ButtonNoPadding, Row } from \"components/lib\";\r\nimport { useAuth } from \"context/auth-context\";\r\nimport { Button, Dropdown, Menu } from \"antd\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ReactComponent as SoftwareLogo } from \"assets/software-logo.svg\";\r\nimport { Navigate, Routes, Route, useNavigate } from \"react-router\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\";\r\nimport { ProjectModal } from \"screens/project-list/project-modal\";\r\nimport { ProjectPopover } from \"components/project-popover\";\r\nimport { UserPopover } from \"components/user-popover\";\r\n\r\nconst ProjectList = React.lazy(() => import(\"screens/project-list\"));\r\nconst ProjectScreen = React.lazy(() => import(\"screens/project\"));\r\n\r\nconst AuthenticatedApp = () => {\r\n  return (\r\n    <Container>\r\n      <Header />\r\n      <Main>\r\n        <Routes>\r\n          <Navigate to={\"/projects\"} replace />\r\n          <Route path={\"/projects\"} element={<ProjectList />} />\r\n          <Route path={\"/projects/:id/*\"} element={<ProjectScreen />} />\r\n        </Routes>\r\n      </Main>\r\n      <ProjectModal />\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default AuthenticatedApp;\r\n\r\nconst Header = () => {\r\n  const navigate = useNavigate();\r\n\r\n  return (\r\n    <PageHeader between={true}>\r\n      <HeaderLeft gap={true}>\r\n        <ButtonNoPadding type=\"link\" onClick={() => navigate(\"/\")}>\r\n          <SoftwareLogo width=\"15rem\" height={\"100%\"} />\r\n        </ButtonNoPadding>\r\n        <ProjectPopover />\r\n        <UserPopover />\r\n      </HeaderLeft>\r\n      <HeaderRight>\r\n        <User />\r\n      </HeaderRight>\r\n    </PageHeader>\r\n  );\r\n};\r\n\r\nconst User = () => {\r\n  const { user, logout } = useAuth();\r\n\r\n  return (\r\n    <Dropdown\r\n      overlay={\r\n        <Menu>\r\n          <Menu.Item key=\"logout\">\r\n            <Button type=\"link\" onClick={() => logout()}>\r\n              登出\r\n            </Button>\r\n          </Menu.Item>\r\n        </Menu>\r\n      }\r\n    >\r\n      <Button type=\"link\">Hi, {user?.name}</Button>\r\n    </Dropdown>\r\n  );\r\n};\r\n\r\nconst Container = styled.div`\r\n  display: grid;\r\n  grid-template-rows: 6rem calc(100vh - 6rem);\r\n  height: 100%;\r\n`;\r\n\r\nconst PageHeader = styled(Row)`\r\n  z-index: 1;\r\n  padding: 3.2rem;\r\n  height: 6rem;\r\n  background-color: white;\r\n  box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);\r\n`;\r\n\r\nconst HeaderLeft = styled(Row)``;\r\n\r\nconst HeaderRight = styled.div``;\r\n\r\nconst Main = styled.main`\r\n  height: calc(100vh - 6rem);\r\n  display: flex;\r\n  overflow: hidden;\r\n`;\r\n"],"sourceRoot":""}